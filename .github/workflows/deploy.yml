name: Deploy to Server

on:
  push:  # ğŸ‘ˆ 'push' ì´ë²¤íŠ¸ì—ì„œ ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •
    branches:
      - main  # ğŸ‘ˆ 'main' ë¸Œëœì¹˜ì— pushë  ë•Œ ì‹¤í–‰

jobs:
  deploy:
    runs-on: self-hosted  # ğŸ‘ˆ GitHub Actions Runnerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3  # ğŸ‘ˆ ì €ì¥ì†Œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°

      - name: Deploy to Local Server
        run: |
          cd /home/sejong/flask_app/smart_city
          git pull origin main
          echo "${{ secrets.SUDO_PASSWORD }}" | sudo -S systemctl restart gunicorn_app
