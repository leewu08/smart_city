{% extends "base.html" %}
{% block content %}
<h1>ğŸ“¡ ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„°</h1>
    <div class="data-container">
        <h2>ì„¼ì„œ ê°’</h2>
        <div id="sensor-data">
            <p class="data-item">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
    </div>

{% endblock %}
{% block extra_js %}
<script>
    // ì£¼ê¸°ì ìœ¼ë¡œ Flask APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    function fetchSensorData() {
        fetch('/api')
            .then(response => response.json())
            .then(data => {
                console.log("ğŸ“© ë°›ì€ ë°ì´í„°:", data);

                // ë°ì´í„°ë¥¼ í‘œì‹œí•  HTML ìš”ì†Œ
                let sensorDataDiv = document.getElementById("sensor-data");
                sensorDataDiv.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

                // ë°ì´í„° ê°ì²´ë¥¼ ë°˜ë³µí•˜ë©° HTMLì— ì¶”ê°€
                for (let key in data) {
                    let value = data[key];
                    let p = document.createElement("p");
                    p.classList.add("data-item");
                    p.innerHTML = `<strong>${key}:</strong> ${value}`;
                    sensorDataDiv.appendChild(p);
                }
            })
            .catch(error => console.error("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", error));
    }

    // 2ì´ˆë§ˆë‹¤ ë°ì´í„° ê°±ì‹ 
    setInterval(fetchSensorData, 2000);

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° í•œ ë²ˆ ê°€ì ¸ì˜¤ê¸°
    fetchSensorData();
</script>
{% endblock %}